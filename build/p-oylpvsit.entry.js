import{r as t,h as i}from"./p-b8715656.js";import"./p-7a9e9a82.js";import{W as s}from"./p-df228fe8.js";const o=class{constructor(i){t(this,i),this.posts=[],this.loading=!1,this.onlyShowCensored=!1,this.hashtag="",this.decodedHashtag="",this.postCount=0,this.offset=0,this._loadingController=null}componentWillLoad(){this.decodedHashtag=decodeURIComponent(this.hashtag)}componentDidLoad(){this.setLoading(!0),s.getPostHashtagIndex(this.decodedHashtag,this.offset,20).subscribe(t=>{this.posts=[...this.posts.concat(t)],console.log("displaying "+this.posts.length+" posts"),this.posts.length>0&&this.setLoading(!1)})}toggleCensoredFilter(){this.posts.length=0,this.offset=0,this.onlyShowCensored=!this.onlyShowCensored,s.getPostHashtagIndex(this.decodedHashtag,this.offset,20,this.onlyShowCensored)}getNextPage(){this.setLoading(!0),this.offset+=20,s.getPostHashtagIndex(this.decodedHashtag,this.offset,20,this.onlyShowCensored)}getPostCount(){return this.onlyShowCensored?s.postHashtagIndex[this.decodedHashtag].posts.filter(t=>t.isCensored).length:s.postHashtagIndex[this.decodedHashtag].posts.length}viewMoreDisplayState(){return this.posts.length>0&&this.posts.length<=this.getPostCount()?"":"viewMoreHidden"}async setLoading(t){this.loading=t}render(){return[i("ion-header",{translucent:!0},i("ion-toolbar",{color:"light"},i("ion-buttons",{slot:"start"},i("ion-back-button",{defaultHref:"/"})),i("ion-buttons",{slot:"end"},i("sharing-utensil",{linkToShare:"http://weibot.saladface.xyz/search-results/"+encodeURIComponent(this.decodedHashtag.replace("#","")).replace("%23",""),text:"%23WeiBlocked %23FreeSpeechChina"})),i("ion-title",null,this.decodedHashtag," - ",s.hashtagIndex.filter(t=>t.hashtag==this.decodedHashtag)[0].english)),i("ion-toolbar",null,this.posts.length>0?i("ion-title",null,"Loaded ",this.posts.length," of ",this.getPostCount()," Posts"):i("ion-title",null,"Loading... Please Wait"))),i("ion-content",{class:"ion-padding"},this.posts.length>0?i("div",{class:"posts-container"},this.posts.map(t=>i("weibo-post",{censored:t.isCensored,downloadFromBlockchain:!1,displayMode:"thumbnail",txid:t.txid}))):"",i("ion-button",{disabled:this.loading,class:this.viewMoreDisplayState(),onClick:t=>(this.getNextPage(),console.log(t),!1),expand:"block",fill:"outline"},"View More...")),i("ion-footer",{color:"light"},i("censored-filter",{censored:this.onlyShowCensored,onToggle:()=>this.toggleCensoredFilter()}))]}static get style(){return":host{display:block}.hscroll{width:100%;overflow-y:auto}.min-500{min-width:900px!important;width:100%}.chinese-text{font-size:10px}.darkred{color:#c00!important}.cta a{font-weight:700;font-size:11px;text-decoration:none}"}};export{o as weibo_posts};