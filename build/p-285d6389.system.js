var __extends=this&&this.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r]};return t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var __awaiter=this&&this.__awaiter||function(t,e,r,n){function i(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,o){function s(t){try{u(n.next(t))}catch(e){o(e)}}function a(t){try{u(n["throw"](t))}catch(e){o(e)}}function u(t){t.done?r(t.value):i(t.value).then(s,a)}u((n=n.apply(t,e||[])).next())}))};var __generator=this&&this.__generator||function(t,e){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(t){return function(e){return u([t,e])}}function u(s){if(n)throw new TypeError("Generator is already executing.");while(r)try{if(n=1,i&&(o=s[0]&2?i["return"]:s[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;if(i=0,o)s=[s[0]&2,o.value];switch(s[0]){case 0:case 1:o=s;break;case 4:r.label++;return{value:s[1],done:false};case 5:r.label++;i=s[1];s=[0];continue;case 7:s=r.ops.pop();r.trys.pop();continue;default:if(!(o=r.trys,o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){r.label=s[1];break}if(s[0]===6&&r.label<o[1]){r.label=o[1];o=s;break}if(o&&r.label<o[2]){r.label=o[2];r.ops.push(s);break}if(o[2])r.ops.pop();r.trys.pop();continue}s=e.call(t,r)}catch(a){s=[6,a];i=0}finally{n=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}};System.register([],(function(t){"use strict";return{execute:function(){function e(t){return typeof t==="function"}var r=false;var n={Promise:undefined,set useDeprecatedSynchronousErrorHandling(t){if(t){var e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else if(r){console.log("RxJS: Back to a better error behavior. Thank you. <3")}r=t},get useDeprecatedSynchronousErrorHandling(){return r}};function i(t){setTimeout((function(){throw t}),0)}var o={closed:true,next:function(t){},error:function(t){if(n.useDeprecatedSynchronousErrorHandling){throw t}else{i(t)}},complete:function(){}};var s=function(){return Array.isArray||function(t){return t&&typeof t.length==="number"}}();function a(t){return t!==null&&typeof t==="object"}var u=function(){function t(t){Error.call(this);this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"";this.name="UnsubscriptionError";this.errors=t;return this}t.prototype=Object.create(Error.prototype);return t}();var c=u;var l=function(){function t(t){this.closed=false;this._parentOrParents=null;this._subscriptions=null;if(t){this._unsubscribe=t}}t.prototype.unsubscribe=function(){var r;if(this.closed){return}var n=this,i=n._parentOrParents,o=n._unsubscribe,u=n._subscriptions;this.closed=true;this._parentOrParents=null;this._subscriptions=null;if(i instanceof t){i.remove(this)}else if(i!==null){for(var l=0;l<i.length;++l){var f=i[l];f.remove(this)}}if(e(o)){try{o.call(this)}catch(v){r=v instanceof c?h(v.errors):[v]}}if(s(u)){var l=-1;var p=u.length;while(++l<p){var d=u[l];if(a(d)){try{d.unsubscribe()}catch(v){r=r||[];if(v instanceof c){r=r.concat(h(v.errors))}else{r.push(v)}}}}}if(r){throw new c(r)}};t.prototype.add=function(e){var r=e;if(!e){return t.EMPTY}switch(typeof e){case"function":r=new t(e);case"object":if(r===this||r.closed||typeof r.unsubscribe!=="function"){return r}else if(this.closed){r.unsubscribe();return r}else if(!(r instanceof t)){var n=r;r=new t;r._subscriptions=[n]}break;default:{throw new Error("unrecognized teardown "+e+" added to Subscription.")}}var i=r._parentOrParents;if(i===null){r._parentOrParents=this}else if(i instanceof t){if(i===this){return r}r._parentOrParents=[i,this]}else if(i.indexOf(this)===-1){i.push(this)}else{return r}var o=this._subscriptions;if(o===null){this._subscriptions=[r]}else{o.push(r)}return r};t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);if(r!==-1){e.splice(r,1)}}};return t}();l.EMPTY=function(t){t.closed=true;return t}(new l);function h(t){return t.reduce((function(t,e){return t.concat(e instanceof c?e.errors:e)}),[])}var f=function(){return typeof Symbol==="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}();var p=function(t){__extends(e,t);function e(r,n,i){var s=t.call(this)||this;s.syncErrorValue=null;s.syncErrorThrown=false;s.syncErrorThrowable=false;s.isStopped=false;switch(arguments.length){case 0:s.destination=o;break;case 1:if(!r){s.destination=o;break}if(typeof r==="object"){if(r instanceof e){s.syncErrorThrowable=r.syncErrorThrowable;s.destination=r;r.add(s)}else{s.syncErrorThrowable=true;s.destination=new d(s,r)}break}default:s.syncErrorThrowable=true;s.destination=new d(s,r,n,i);break}return s}e.prototype[f]=function(){return this};e.create=function(t,r,n){var i=new e(t,r,n);i.syncErrorThrowable=false;return i};e.prototype.next=function(t){if(!this.isStopped){this._next(t)}};e.prototype.error=function(t){if(!this.isStopped){this.isStopped=true;this._error(t)}};e.prototype.complete=function(){if(!this.isStopped){this.isStopped=true;this._complete()}};e.prototype.unsubscribe=function(){if(this.closed){return}this.isStopped=true;t.prototype.unsubscribe.call(this)};e.prototype._next=function(t){this.destination.next(t)};e.prototype._error=function(t){this.destination.error(t);this.unsubscribe()};e.prototype._complete=function(){this.destination.complete();this.unsubscribe()};e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;this._parentOrParents=null;this.unsubscribe();this.closed=false;this.isStopped=false;this._parentOrParents=t;return this};return e}(l);var d=function(t){__extends(r,t);function r(r,n,i,s){var a=t.call(this)||this;a._parentSubscriber=r;var u;var c=a;if(e(n)){u=n}else if(n){u=n.next;i=n.error;s=n.complete;if(n!==o){c=Object.create(n);if(e(c.unsubscribe)){a.add(c.unsubscribe.bind(c))}c.unsubscribe=a.unsubscribe.bind(a)}}a._context=c;a._next=u;a._error=i;a._complete=s;return a}r.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;if(!n.useDeprecatedSynchronousErrorHandling||!e.syncErrorThrowable){this.__tryOrUnsub(this._next,t)}else if(this.__tryOrSetError(e,this._next,t)){this.unsubscribe()}}};r.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber;var r=n.useDeprecatedSynchronousErrorHandling;if(this._error){if(!r||!e.syncErrorThrowable){this.__tryOrUnsub(this._error,t);this.unsubscribe()}else{this.__tryOrSetError(e,this._error,t);this.unsubscribe()}}else if(!e.syncErrorThrowable){this.unsubscribe();if(r){throw t}i(t)}else{if(r){e.syncErrorValue=t;e.syncErrorThrown=true}else{i(t)}this.unsubscribe()}}};r.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};if(!n.useDeprecatedSynchronousErrorHandling||!e.syncErrorThrowable){this.__tryOrUnsub(r);this.unsubscribe()}else{this.__tryOrSetError(e,r);this.unsubscribe()}}else{this.unsubscribe()}}};r.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(r){this.unsubscribe();if(n.useDeprecatedSynchronousErrorHandling){throw r}else{i(r)}}};r.prototype.__tryOrSetError=function(t,e,r){if(!n.useDeprecatedSynchronousErrorHandling){throw new Error("bad call")}try{e.call(this._context,r)}catch(o){if(n.useDeprecatedSynchronousErrorHandling){t.syncErrorValue=o;t.syncErrorThrown=true;return true}else{i(o);return true}}return false};r.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null;this._parentSubscriber=null;t.unsubscribe()};return r}(p);function v(t){while(t){var e=t.closed,r=t.destination,n=t.isStopped;if(e||n){return false}else if(r&&r instanceof p){t=r}else{t=null}}return true}function b(t,e,r){if(t){if(t instanceof p){return t}if(t[f]){return t[f]()}}if(!t&&!e&&!r){return new p(o)}return new p(t,e,r)}var _=function(){return typeof Symbol==="function"&&Symbol.observable||"@@observable"}();function y(){}function g(t){if(!t){return y}if(t.length===1){return t[0]}return function e(r){return t.reduce((function(t,e){return e(t)}),r)}}var w=function(){function t(t){this._isScalar=false;if(t){this._subscribe=t}}t.prototype.lift=function(e){var r=new t;r.source=this;r.operator=e;return r};t.prototype.subscribe=function(t,e,r){var i=this.operator;var o=b(t,e,r);if(i){o.add(i.call(o,this.source))}else{o.add(this.source||n.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o))}if(n.useDeprecatedSynchronousErrorHandling){if(o.syncErrorThrowable){o.syncErrorThrowable=false;if(o.syncErrorThrown){throw o.syncErrorValue}}}return o};t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){if(n.useDeprecatedSynchronousErrorHandling){t.syncErrorThrown=true;t.syncErrorValue=e}if(v(t)){t.error(e)}else{console.warn(e)}}};t.prototype.forEach=function(t,e){var r=this;e=m(e);return new e((function(e,n){var i;i=r.subscribe((function(e){try{t(e)}catch(r){n(r);if(i){i.unsubscribe()}}}),n,e)}))};t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)};t.prototype[_]=function(){return this};t.prototype.pipe=function(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}if(t.length===0){return this}return g(t)(this)};t.prototype.toPromise=function(t){var e=this;t=m(t);return new t((function(t,r){var n;e.subscribe((function(t){return n=t}),(function(t){return r(t)}),(function(){return t(n)}))}))};return t}();w.create=function(t){return new w(t)};function m(t){if(!t){t=Promise}if(!t){throw new Error("no Promise impl found")}return t}var S=function(){function t(){Error.call(this);this.message="object unsubscribed";this.name="ObjectUnsubscribedError";return this}t.prototype=Object.create(Error.prototype);return t}();var T=S;var x=function(t){__extends(e,t);function e(e,r){var n=t.call(this)||this;n.subject=e;n.subscriber=r;n.closed=false;return n}e.prototype.unsubscribe=function(){if(this.closed){return}this.closed=true;var t=this.subject;var e=t.observers;this.subject=null;if(!e||e.length===0||t.isStopped||t.closed){return}var r=e.indexOf(this.subscriber);if(r!==-1){e.splice(r,1)}};return e}(l);var E=function(t){__extends(e,t);function e(e){var r=t.call(this,e)||this;r.destination=e;return r}return e}(p);var O=function(t){__extends(e,t);function e(){var e=t.call(this)||this;e.observers=[];e.closed=false;e.isStopped=false;e.hasError=false;e.thrownError=null;return e}e.prototype[f]=function(){return new E(this)};e.prototype.lift=function(t){var e=new k(this,this);e.operator=t;return e};e.prototype.next=function(t){if(this.closed){throw new T}if(!this.isStopped){var e=this.observers;var r=e.length;var n=e.slice();for(var i=0;i<r;i++){n[i].next(t)}}};e.prototype.error=function(t){if(this.closed){throw new T}this.hasError=true;this.thrownError=t;this.isStopped=true;var e=this.observers;var r=e.length;var n=e.slice();for(var i=0;i<r;i++){n[i].error(t)}this.observers.length=0};e.prototype.complete=function(){if(this.closed){throw new T}this.isStopped=true;var t=this.observers;var e=t.length;var r=t.slice();for(var n=0;n<e;n++){r[n].complete()}this.observers.length=0};e.prototype.unsubscribe=function(){this.isStopped=true;this.closed=true;this.observers=null};e.prototype._trySubscribe=function(e){if(this.closed){throw new T}else{return t.prototype._trySubscribe.call(this,e)}};e.prototype._subscribe=function(t){if(this.closed){throw new T}else if(this.hasError){t.error(this.thrownError);return l.EMPTY}else if(this.isStopped){t.complete();return l.EMPTY}else{this.observers.push(t);return new x(this,t)}};e.prototype.asObservable=function(){var t=new w;t.source=this;return t};return e}(w);O.create=function(t,e){return new k(t,e)};var k=function(t){__extends(e,t);function e(e,r){var n=t.call(this)||this;n.destination=e;n.source=r;return n}e.prototype.next=function(t){var e=this.destination;if(e&&e.next){e.next(t)}};e.prototype.error=function(t){var e=this.destination;if(e&&e.error){this.destination.error(t)}};e.prototype.complete=function(){var t=this.destination;if(t&&t.complete){this.destination.complete()}};e.prototype._subscribe=function(t){var e=this.source;if(e){return this.source.subscribe(t)}else{return l.EMPTY}};return e}(O);var A=function(t){__extends(e,t);function e(e){var r=t.call(this)||this;r._value=e;return r}Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:true,configurable:true});e.prototype._subscribe=function(e){var r=t.prototype._subscribe.call(this,e);if(r&&!r.closed){e.next(this._value)}return r};e.prototype.getValue=function(){if(this.hasError){throw this.thrownError}else if(this.closed){throw new T}else{return this._value}};e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)};return e}(O);var P={production:false,AR_APP_ID:"coronavirus.api",API_VERSION:"1.0.2",DEFAULT_COLLECTION_ID:"regional.daily"};function I(t,e){return{op:"equals",expr1:t,expr2:e}}function R(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}if(t.length==0){throw new Error("0 arguments pass to and()")}if(t.length==1){return t[0]}var r={op:"and",expr1:t.shift(),expr2:t.length>1?R.apply(void 0,t):t[0]};return r}function N(t,e){return e={exports:{}},t(e,e.exports),e.exports}function D(t,e){if(typeof e==="boolean"){e={forever:e}}this._originalTimeouts=JSON.parse(JSON.stringify(t));this._timeouts=t;this._options=e||{};this._maxRetryTime=e&&e.maxRetryTime||Infinity;this._fn=null;this._errors=[];this._attempts=1;this._operationTimeout=null;this._operationTimeoutCb=null;this._timeout=null;this._operationStart=null;if(this._options.forever){this._cachedTimeouts=this._timeouts.slice(0)}}var H=D;D.prototype.reset=function(){this._attempts=1;this._timeouts=this._originalTimeouts};D.prototype.stop=function(){if(this._timeout){clearTimeout(this._timeout)}this._timeouts=[];this._cachedTimeouts=null};D.prototype.retry=function(t){if(this._timeout){clearTimeout(this._timeout)}if(!t){return false}var e=(new Date).getTime();if(t&&e-this._operationStart>=this._maxRetryTime){this._errors.unshift(new Error("RetryOperation timeout occurred"));return false}this._errors.push(t);var r=this._timeouts.shift();if(r===undefined){if(this._cachedTimeouts){this._errors.splice(this._errors.length-1,this._errors.length);this._timeouts=this._cachedTimeouts.slice(0);r=this._timeouts.shift()}else{return false}}var n=this;var i=setTimeout((function(){n._attempts++;if(n._operationTimeoutCb){n._timeout=setTimeout((function(){n._operationTimeoutCb(n._attempts)}),n._operationTimeout);if(n._options.unref){n._timeout.unref()}}n._fn(n._attempts)}),r);if(this._options.unref){i.unref()}return true};D.prototype.attempt=function(t,e){this._fn=t;if(e){if(e.timeout){this._operationTimeout=e.timeout}if(e.cb){this._operationTimeoutCb=e.cb}}var r=this;if(this._operationTimeoutCb){this._timeout=setTimeout((function(){r._operationTimeoutCb()}),r._operationTimeout)}this._operationStart=(new Date).getTime();this._fn(this._attempts)};D.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated");this.attempt(t)};D.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated");this.attempt(t)};D.prototype.start=D.prototype.try;D.prototype.errors=function(){return this._errors};D.prototype.attempts=function(){return this._attempts};D.prototype.mainError=function(){if(this._errors.length===0){return null}var t={};var e=null;var r=0;for(var n=0;n<this._errors.length;n++){var i=this._errors[n];var o=i.message;var s=(t[o]||0)+1;t[o]=s;if(s>=r){e=i;r=s}}return e};var C=N((function(t,e){e.operation=function(t){var r=e.timeouts(t);return new H(r,{forever:t&&t.forever,unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})};e.timeouts=function(t){if(t instanceof Array){return[].concat(t)}var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:Infinity,randomize:false};for(var r in t){e[r]=t[r]}if(e.minTimeout>e.maxTimeout){throw new Error("minTimeout is greater than maxTimeout")}var n=[];for(var i=0;i<e.retries;i++){n.push(this.createTimeout(i,e))}if(t&&t.forever&&!n.length){n.push(this.createTimeout(i,e))}n.sort((function(t,e){return t-e}));return n};e.createTimeout=function(t,e){var r=e.randomize?Math.random()+1:1;var n=Math.round(r*e.minTimeout*Math.pow(e.factor,t));n=Math.min(n,e.maxTimeout);return n};e.wrap=function(t,r,n){if(r instanceof Array){n=r;r=null}if(!n){n=[];for(var i in t){if(typeof t[i]==="function"){n.push(i)}}}for(var o=0;o<n.length;o++){var s=n[o];var a=t[s];t[s]=function n(i){var o=e.operation(r);var s=Array.prototype.slice.call(arguments,1);var a=s.pop();s.push((function(t){if(o.retry(t)){return}if(t){arguments[0]=o.mainError()}a.apply(this,arguments)}));o.attempt((function(){i.apply(t,s)}))}.bind(t,a);t[s].options=r}}}));var j=C;function V(t,e){function r(r,n){var i=e||{};if(!("randomize"in i)){i.randomize=true}var o=j.operation(i);function s(t){n(t||new Error("Aborted"))}function a(t,e){if(t.bail){s(t);return}if(!o.retry(t)){n(o.mainError())}else if(i.onRetry){i.onRetry(t,e)}}function u(e){var n;try{n=t(s,e)}catch(i){a(i,e);return}Promise.resolve(n).then(r).catch((function t(r){a(r,e)}))}o.attempt(u)}return new Promise(r)}var W=V;var J=function(){function t(){this.arweaveSdk=window["Arweave"].init({host:"arweave.net",port:443,protocol:"https",timeout:3e5,logging:false});this._currentWallet={address:"",balance:0,keystore:null,rawJson:""};this._allChannels=[];this._currentChannel={};console.log("ArweaveServiceService constructor");this.getNetworkStatus((function(t){return console.log(t)}));this.currentWallet$=new A(this._currentWallet);this.allChannels$=new A(this._allChannels);this.currentChannel$=new A(this._currentChannel)}Object.defineProperty(t,"defaultInstance",{get:function(){if(t._instance==null){t._instance=new t}return t._instance},enumerable:true,configurable:true});t.prototype.loadWallet=function(t){return __awaiter(this,void 0,void 0,(function(){var e;var r=this;return __generator(this,(function(n){try{e=JSON.parse(t);this.arweaveSdk.wallets.jwkToAddress(e).then((function(t){r.arweaveSdk.wallets.getBalance(t).then((function(n){r._currentWallet={address:t,balance:n,keystore:e,rawJson:JSON.stringify(e,null,2)};r.currentWallet$.next(r._currentWallet);if(n<1e5){console.log("Balance extremely low, app may not work. Visit tokens.arweave.org and get a new wallet + 1.00000 AR in free tokens")}}))}))}catch(i){console.log(JSON.stringify(i,null,2));alert("Not an Arweave wallet file! Visit tokens.arweave.org and get a new wallet + 1.00000 AR in free tokens")}return[2]}))}))};t.prototype.getItemRaw=function(t){return __awaiter(this,void 0,void 0,(function(){var e,r,n,i;return __generator(this,(function(o){switch(o.label){case 0:return[4,this.arweaveSdk.transactions.get(t)];case 1:e=o.sent();r=e.get("data",{decode:true});n={};e.get("tags").forEach((function(t){var e=t.get("name",{decode:true,string:true});var r=t.get("value",{decode:true,string:true});console.log(e+" : "+r);n[e]=r}));i={id:t,data:r,tags:n};return[2,i]}}))}))};t.prototype.getItemByTxId=function(t){return __awaiter(this,void 0,void 0,(function(){var e,r,n,i;return __generator(this,(function(o){switch(o.label){case 0:return[4,this.arweaveSdk.transactions.get(t)];case 1:e=o.sent();r=JSON.parse(e.get("data",{decode:true,string:true}));n={};e.get("tags").forEach((function(t){var e=t.get("name",{decode:true,string:true});var r=t.get("value",{decode:true,string:true});console.log(e+" : "+r);n[e]=r}));i={id:t,data:r,tags:n};return[2,i]}}))}))};t.prototype.getTransactionsByTags=function(t){return __awaiter(this,void 0,void 0,(function(){var e;var r=this;return __generator(this,(function(n){switch(n.label){case 0:e=[];return[4,W((function(){return __awaiter(r,void 0,void 0,(function(){var r;return __generator(this,(function(n){switch(n.label){case 0:r=R.apply(void 0,t.map((function(t){return I(t.name,t.value.toString())})));return[4,this.arweaveSdk.arql(r)];case 1:e=n.sent();console.log("retrieved "+e.length+" transaction ids matching your query");return[2]}}))}))}),{retries:5})];case 1:n.sent();return[2,e]}}))}))};t.prototype.getCollection=function(t,e){return __awaiter(this,void 0,void 0,(function(){var r,n,i,o,s,a,u,c,l;return __generator(this,(function(h){switch(h.label){case 0:r=[];if(e){n=R(I(e.appName.tag,e.appName.value),I(e.version.tag,e.version.value),I(e.collection.tag,e.collection.value))}else{n=R(I("AR_APP_ID",P.AR_APP_ID),I("AR_COLLECTION_ID",t),I("API_VERSION",P.API_VERSION))}return[4,this.arweaveSdk.arql(n)];case 1:i=h.sent();console.log("step 1: get all transaction ids tagged with AR_COLLECTION_ID == "+t);console.log(JSON.stringify(i));console.log("step 2: each transaction points to an element's contents - retrieve it and insert into our array");if(i.length>100)i=i.slice(0,100);o=0;h.label=2;case 2:if(!(o<i.length))return[3,5];s=i[o];return[4,this.arweaveSdk.transactions.get(s)];case 3:a=h.sent();u=JSON.parse(a.get("data",{decode:true,string:true}));c={};a.get("tags").forEach((function(t){var e=t.get("name",{decode:true,string:true});var r=t.get("value",{decode:true,string:true});console.log(e+" : "+r);c[e]=r;c["txid"]=s}));l={data:u,tags:c};r.push(l);h.label=4;case 4:o++;return[3,2];case 5:console.log("success: the collection has been downloaded from the blockchain");return[2,r]}}))}))};t.prototype.loginWithWalletString=function(t){var e=this;try{var r=JSON.parse(t);this.arweaveSdk.wallets.jwkToAddress(r).then((function(t){e.arweaveSdk.wallets.getBalance(t).then((function(n){e._currentWallet={address:t,balance:n,keystore:r,rawJson:JSON.stringify(r,null,2)};e.currentWallet$.next(e._currentWallet);if(n<1e5){console.log("Balance extremely low, app may not work. Visit tokens.arweave.org and get a new wallet + 1.00000 AR in free tokens")}}))}))}catch(n){console.log(JSON.stringify(n,null,2));alert("Not an Arweave wallet file! Visit tokens.arweave.org and get a new wallet + 1.00000 AR in free tokens")}};t.prototype.loginWithWalletFile=function(t){var e=this;var r=new FileReader;r.readAsText(t);r.onloadend=function(){e.loginWithWalletString(r.result)}};t.prototype.getNetworkStatus=function(t){this.arweaveSdk.network.getInfo().then((function(e){return t(e)}))};return t}();J._instance=null;var B=function(){function t(){this.censoredHashtagStrings=[];this.censoredHashtags=[];this.hashtagIndex=[];this.hashtagIndex$=new A([]);this.postTxids=[];this.posts=[];this.posts$=new A([]);this.arweaveService=J.defaultInstance}t.prototype.getPostsByHashtag=function(t,e,r){return __awaiter(this,void 0,void 0,(function(){var n,i,o,s,a;return __generator(this,(function(u){switch(u.label){case 0:this.posts=[];this.posts$.next(this.posts);n=[{name:"App-Name",value:"weibot-search-weibs"},{name:"App-Version",value:"0.2.0"},{name:t,value:1}];i=this;return[4,this.arweaveService.getTransactionsByTags(n)];case 1:i.postTxids=u.sent();o=this.postTxids.slice(e,r);s=0;u.label=2;case 2:if(!(s<o.length))return[3,5];return[4,this.arweaveService.getItemRaw(o[s])];case 3:a=u.sent();this.posts.push(a);u.label=4;case 4:s++;return[3,2];case 5:this.posts$.next(this.posts);return[2]}}))}))};t.prototype.getPostsBySearchTxid=function(t,e,r){return __awaiter(this,void 0,void 0,(function(){var n,i,o,s,a;return __generator(this,(function(u){switch(u.label){case 0:this.posts=[];this.posts$.next(this.posts);n=[{name:"App-Name",value:"weibot-search-weibs"},{name:"App-Version",value:"0.2.0"},{name:"Search-Tx",value:t}];i=this;return[4,this.arweaveService.getTransactionsByTags(n)];case 1:i.postTxids=u.sent();o=this.postTxids.slice(e,r);s=0;u.label=2;case 2:if(!(s<o.length))return[3,5];return[4,this.arweaveService.getItemRaw(o[s])];case 3:a=u.sent();this.posts.push(a);u.label=4;case 4:s++;return[3,2];case 5:this.posts$.next(this.posts);return[2]}}))}))};t.prototype.getCensoredHashtags=function(t){if(t===void 0){t=false}return __awaiter(this,void 0,void 0,(function(){var e,r,n;return __generator(this,(function(i){switch(i.label){case 0:if(!(this.censoredHashtagStrings.length==0||t))return[3,3];e=[{name:"App-Name",value:"weibot-censored-hashtags"},{name:"App-Version",value:"0.2.0"}];return[4,this.arweaveService.getTransactionsByTags(e)];case 1:r=i.sent();return[4,this.arweaveService.getItemByTxId(r[0])];case 2:n=i.sent();this.censoredHashtagStrings=n.data.unsearchable.map((function(t){return t.ht}));this.censoredHashtags=n.data.unsearchable.map((function(t){return{hashtag:t.ht,count:t.n,censored:true}})).sort((function(t,e){return e.count-t.count}));i.label=3;case 3:return[2,this.censoredHashtagStrings]}}))}))};t.prototype.getHashtagIndex=function(t,e,r){if(r===void 0){r=false}return __awaiter(this,void 0,void 0,(function(){var n,i,o;var s=this;return __generator(this,(function(a){switch(a.label){case 0:return[4,this.getCensoredHashtags()];case 1:a.sent();if(!(this.hashtagIndex.length==0||r))return[3,4];n=[{name:"App-Name",value:"weibot-search-index"},{name:"App-Version",value:"0.2.0"},{name:"Search-Type",value:"hashtag"}];return[4,this.arweaveService.getTransactionsByTags(n)];case 2:i=a.sent();return[4,this.arweaveService.getItemByTxId(i[0])];case 3:o=a.sent();this.hashtagIndex=o.data.map((function(t){return{hashtag:t.hashtag,count:t.count,censored:s.censoredHashtagStrings.includes(t.hashtag)}}));a.label=4;case 4:this.hashtagIndex$.next(this.hashtagIndex.slice(t,e+t));return[2]}}))}))};return t}();var $=t("W",new B)}}}));